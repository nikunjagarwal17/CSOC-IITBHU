# Protostar Exploits Writeups.

[Link](https://exploit.education/protostar/)


After setting up the Protostate we can connect to it using the ssh on our localhost and can go into the /bin/sh shell.
![image](https://github.com/nikunjagarwal17/CSOC-IITBHU/assets/144536875/7c4443a6-6d96-4910-ad98-ae14744bd6ec)

> Username: user
> 
> Password: user


## Stack 0

This level introduces the concept that memory can be accessed outside of its allocated region, how the stack variables are laid out, and that modifying outside of the allocated memory can modify program execution.

Source Code

```c
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>

int main(int argc, char **argv)
{
  volatile int modified;
  char buffer[64];

  modified = 0;
  gets(buffer);

  if(modified != 0) {
      printf("you have changed the 'modified' variable\n");
  } else {
      printf("Try again?\n");
  }
}
```

So in thei program we have to basically modify the value to the variable "modified" and run the code so that the part to code that is not desirable to run can be run.

we know that the gets function is a buggy function we can also check into the man page.

![image](https://github.com/nikunjagarwal17/CSOC-IITBHU/assets/144536875/b09a466e-8aeb-401a-b8cc-ce6f72bb32b0)

using the gets function we can overwrite the stack as we cannot control the input size of the gets function it continues to take the input.

lets check into the disassebly code and check for the stack.
opening the program in GDB and disassemblying the main function.

![image](https://github.com/nikunjagarwal17/CSOC-IITBHU/assets/144536875/132f6a48-4850-4114-adbe-100440e9c3a3)

setting the break pointer and runneing the code with sample input and cheking for the registers value we can clearly see that the buffer value starts from the 0xbffff76b to 0xbffff7ab and the next 4 bytes that are for the modified variable are kept to 0 also we can see that it follows little endian format.

![image](https://github.com/nikunjagarwal17/CSOC-IITBHU/assets/144536875/945028f6-d348-4d4a-a609-2341ea2ee30d)

so basically we have to write a byte array that is larger than ```0xbffff7ab - 0xbffff76b = 64``` to over flow into the next variable.

![image](https://github.com/nikunjagarwal17/CSOC-IITBHU/assets/144536875/60904dff-8466-4db6-9ba9-fcc8964a9c4d)

![image](https://github.com/nikunjagarwal17/CSOC-IITBHU/assets/144536875/11d9aa2d-08a1-49ab-b08f-6aa1d4fcb855)

and are we are done.

we can also use the following script to do so.

























